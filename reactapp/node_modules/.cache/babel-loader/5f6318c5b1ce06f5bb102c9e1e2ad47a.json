{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\aarun\\\\PycharmProjects\\\\clusters\\\\reactapp\\\\src\\\\components\\\\ChatRoom.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { useAuth } from '../contexts/AuthContext';\nimport io from 'socket.io-client';\nconst socket = io.connect('http://127.0.0.1:5000/messaging');\nexport function ChatRoom() {\n  _s();\n\n  const {\n    currentUser\n  } = useAuth();\n  const [chatsList, setChatsList] = useState([]);\n  const [chat, setChat] = useState({});\n  const [messages, setMessages] = useState([]);\n  const [message, setMessage] = useState('');\n  socket.on('newMessage', message => setMessages([...messages, message]));\n  socket.on('message', message => setMessages([...messages, message]));\n  useEffect(async () => {\n    try {\n      const data = await fetch(currentUser.links.chats).then(response => {\n        if (response.ok) {\n          return response.json();\n        }\n      });\n      socket.emit('join', {\n        userId: currentUser.id\n      });\n      setChatsList(data);\n    } catch (err) {\n      setError('Failed to grab all chats');\n    }\n  }, [currentUser]);\n\n  async function handleChatClick(chat) {\n    try {\n      const data = await fetch(chat.links.messages).then(response => {\n        if (response.ok) {\n          return response.json();\n        }\n      });\n      setChat(chat);\n      setMessages(data);\n    } catch (err) {\n      setError('Failed to display chat');\n    }\n  }\n\n  function handleSendMessage() {\n    socket.emit('message', {\n      senderId: currentUser.id,\n      chatId: chat.id,\n      message: message.message\n    });\n    setMessage('');\n  }\n\n  function renderChatsList() {\n    return chatsList.map(chat => {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: chat.recipientName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleChatClick(chat),\n          children: \"Select\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 17\n      }, this);\n    });\n  }\n\n  function renderSpecificChat() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: chat.recipientName\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: messages.map(message => {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 70,\n              columnNumber: 33\n            }, this), message.message]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 29\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        value: message,\n        onChange: e => setMessage(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSendMessage,\n        children: \"Send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 13\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [renderChatsList(), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }, this), renderSpecificChatChat()]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 9\n  }, this);\n}\n\n_s(ChatRoom, \"l1aeK5z6CKIVmczxGV7GnwYbWyE=\", false, function () {\n  return [useAuth];\n});\n\n_c = ChatRoom;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChatRoom\");","map":{"version":3,"sources":["C:/Users/aarun/PycharmProjects/clusters/reactapp/src/components/ChatRoom.js"],"names":["React","useState","useEffect","useAuth","io","socket","connect","ChatRoom","currentUser","chatsList","setChatsList","chat","setChat","messages","setMessages","message","setMessage","on","data","fetch","links","chats","then","response","ok","json","emit","userId","id","err","setError","handleChatClick","handleSendMessage","senderId","chatId","renderChatsList","map","recipientName","renderSpecificChat","e","target","value","renderSpecificChatChat"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\r\nimport {useAuth} from '../contexts/AuthContext';\r\nimport io from 'socket.io-client';\r\n\r\nconst socket = io.connect('http://127.0.0.1:5000/messaging');\r\n\r\nexport function ChatRoom(){\r\n\r\n    const {currentUser} = useAuth();\r\n    const [chatsList, setChatsList] = useState([]);\r\n    const [chat, setChat] = useState({});\r\n    const [messages, setMessages] = useState([]);\r\n    const [message, setMessage] = useState('');\r\n\r\n    socket.on('newMessage', message => setMessages([...messages, message]));\r\n    socket.on('message', message => setMessages([...messages, message]));\r\n\r\n    useEffect(async () => {\r\n        try {\r\n            const data = await fetch(currentUser.links.chats).then(response => {\r\n                if(response.ok){\r\n                    return response.json();\r\n                }\r\n            });\r\n            socket.emit('join', {userId: currentUser.id})\r\n            setChatsList(data);\r\n        } catch(err) {\r\n            setError('Failed to grab all chats')\r\n        }\r\n    }, [currentUser]);\r\n\r\n    async function handleChatClick(chat){\r\n        try {\r\n            const data = await fetch(chat.links.messages).then(response => {\r\n                if(response.ok){\r\n                    return response.json();\r\n                }\r\n            });\r\n            setChat(chat);\r\n            setMessages(data);\r\n        } catch(err) {\r\n            setError('Failed to display chat');\r\n        }\r\n    }\r\n\r\n    function handleSendMessage(){\r\n        socket.emit('message', {senderId: currentUser.id, chatId: chat.id, message: message.message});\r\n        setMessage('');\r\n    }\r\n\r\n    function renderChatsList(){\r\n        return chatsList.map(chat => {\r\n            return (\r\n                <div>\r\n                    <h3>{chat.recipientName}</h3>\r\n                    <button onClick={() => handleChatClick(chat)}>Select</button>\r\n                </div>\r\n            );\r\n        });\r\n    }\r\n\r\n    function renderSpecificChat(){\r\n        return (\r\n            <div>\r\n                <h2>{chat.recipientName}</h2>\r\n                <div>\r\n                    {messages.map(message => {\r\n                        return (\r\n                            <div>\r\n                                <br/>\r\n                                {message.message}\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n                <br/>\r\n                <input value={message} onChange={e => setMessage(e.target.value)}/>\r\n                <button onClick={handleSendMessage}>Send</button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            {renderChatsList()}\r\n            <br/>\r\n            {renderSpecificChatChat()}\r\n        </div>\r\n    )\r\n\r\n}"]},"metadata":{},"sourceType":"module"}